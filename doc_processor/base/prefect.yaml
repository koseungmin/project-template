name: prefect-document-pipeline
prefect-version: 3.0.0

deployments:
  - name: document-processing-pipeline
    entrypoint: /app/flow/document_processing_pipeline.py:document_processing_pipeline
    description: 4단계 문서 처리 파이프라인 - 텍스트 추출, 이미지 캡처, GPT 설명, Vector DB 구성 (분리된 API 버전)
    work_pool:
      name: default
      work_queue_name: default
    parameters:
      document_path: ""
      max_pages: 5
    schedule:
      cron: "0 0 1 1 *"  # 매년 1월 1일 자정 (1년에 한번)
      timezone: "Asia/Seoul"
    # 환경 변수 설정 - 실제 값을 여기에 설정하세요
    env:
      AZURE_OPENAI_ENDPOINT: ""
      AZURE_OPENAI_KEY: ""
      AZURE_OPENAI_API_VERSION: ""
      AZURE_OPENAI_DEPLOYMENT_NAME: ""
      AZURE_OPENAI_EMBEDDING_API_VERSION: ""
      AZURE_OPENAI_EMBEDDING_DEPLOYMENT: ""
      MILVUS_URI: "./milvus_lite.db"
      MILVUS_COLLECTION_NAME: "document_vectors"
      OUTPUT_DIR: ""
      MAX_PAGES_TO_PROCESS: "5"
  
  - name: batch-document-processing-pipeline
    entrypoint: /app/flow/batch_document_processing_pipeline.py:batch_document_processing_pipeline
    description: 폴더의 모든 PDF 파일을 일괄 처리하는 배치 파이프라인 (실제 태스크 직접 실행)
    work_pool:
      name: default
      work_queue_name: default
    parameters:
      folder_path: ""
      max_pages: 5
      max_file_size_mb: 50.0
      skip_existing: true
    schedule:
      cron: "0 0 1 1 *"  # 매년 1월 1일 자정 (1년에 한번)
      timezone: "Asia/Seoul"
    # 환경 변수 설정 - 실제 값을 여기에 설정하세요
    env:
      AZURE_OPENAI_ENDPOINT: ""
      AZURE_OPENAI_KEY: ""
      AZURE_OPENAI_API_VERSION: ""
      AZURE_OPENAI_DEPLOYMENT_NAME: ""
      AZURE_OPENAI_EMBEDDING_API_VERSION: ""
      AZURE_OPENAI_EMBEDDING_DEPLOYMENT: ""
      MILVUS_URI: "./milvus_lite.db"
      MILVUS_COLLECTION_NAME: "document_vectors"
      OUTPUT_DIR: ""
      MAX_PAGES_TO_PROCESS: "5" 